
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Time Storage</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      margin: 0;
    }
  </style>
</head>
<body>
  <div>
    <input type="time" id="timeInput">
    <button id="saveButton">Save Time</button>
    <button id="loadButton">Load Time</button>
  </div>

  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAob-IJWewda_XEEqhTjp8aZtwQ3e4ymz8",
      authDomain: "my-audio-emailer.firebaseapp.com",
      projectId: "my-audio-emailer",
      storageBucket: "my-audio-emailer.appspot.com",
      messagingSenderId: "801207008698",
      appId: "1:801207008698:web:649ddd92c31df7798bb183"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    document.getElementById('saveButton').addEventListener('click', saveTime);
    document.getElementById('loadButton').addEventListener('click', loadTime);

    async function saveTime() {
      const time = document.getElementById('timeInput').value;
      try {
        await db.collection('times').doc('lastTime').set({ time });
        alert('Time saved successfully.');
      } catch (error) {
        console.error('Error saving time:', error);
        alert('Failed to save time.');
      }
    }

    async function loadTime() {
      try {
        const doc = await db.collection('times').doc('lastTime').get();
        if (doc.exists) {
          document.getElementById('timeInput').value = doc.data().time;
          alert('Time loaded successfully.');
        } else {
          alert('No time saved yet.');
        }
      } catch (error) {
        console.error('Error loading time:', error);
        alert('Failed to load time.');
      }
    }
  </script>
</body>
</html>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script>
    // Combine Firebase and TTS code
    const firebaseConfig = {
      apiKey: "AIzaSyAob-IJWewda_XEEqhTjp8aZtwQ3e4ymz8",
      authDomain: "my-audio-emailer.firebaseapp.com",
      projectId: "my-audio-emailer",
      storageBucket: "my-audio-emailer.appspot.com",
      messagingSenderId: "801207008698",
      appId: "1:801207008698:web:649ddd92c31df7798bb183"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    document.getElementById('saveButton').addEventListener('click', saveTime);
    document.getElementById('loadButton').addEventListener('click', loadTime);

    async function saveTime() {
      const time = document.getElementById('timeInput').value;
      try {
        await db.collection('times').doc('lastTime').set({ time });
        alert('Time saved successfully.');
      } catch (error) {
        console.error('Error saving time:', error);
        alert('Failed to save time.');
      }
    }

    async function loadTime() {
      try {
        const doc = await db.collection('times').doc('lastTime').get();
        if (doc.exists) {
          document.getElementById('timeInput').value = doc.data().time;
          alert('Time loaded successfully.');
        } else {
          alert('No time saved yet.');
        }
      } catch (error) {
        console.error('Error loading time:', error);
        alert('Failed to load time.');
      }
    }

    // TTS code
    const synth = window.speechSynthesis;
    const voiceSelect = document.querySelector('#lang');
    const pitchInput = document.querySelector('#pitch');
    const rateInput = document.querySelector('#rate');
    const volumeInput = document.querySelector('#volume');
    const textArea = document.querySelector('#text');

    setTimeout(() => {
      const selectChild = synth.getVoices().reduce((res, ite) => {
        return res += `<option value="${ite.lang}" data-name="${ite.name}">${ite.lang} - ${ite.name}</option>`
      }, '');
      voiceSelect.innerHTML = selectChild;
    }, 50);

    function limitVal({ ele, min, max }) {
      if (ele.value > max) {
        ele.value = max;
      } else if (ele.value < min) {
        ele.value = min;
      }
    }

    pitchInput.onblur = () => {
      limitVal({ ele: pitchInput, min: 0, max: 2 });
    };

    rateInput.onblur = () => {
      limitVal({ ele: rateInput, min: 0, max: 10 });
    };

    volumeInput.onblur = () => {
      limitVal({ ele: volumeInput, min: 0, max: 1 });
    };
    function startRead() {
  const selectedOption = voiceSelect.selectedOptions[0].getAttribute('data-name');
  const voices = synth.getVoices();
  for (let i = 0; i < voices.length; i++) {
    if (voices[i].name === selectedOption) {
      const utterThis = new window.SpeechSynthesisUtterance(textArea.value);
      utterThis.voice = voices[i];
      utterThis.pitch = pitchInput.value;
      utterThis.rate = rateInput.value;
      utterThis.volume = volumeInput.value;
      synth.speak(utterThis);
      break;
    }
  }
}

function pause() {
  synth.pause();
}

function continueSpeak() {
  synth.resume();
}

async function checkTimeAndSpeak() {
  try {
    const doc = await db.collection('times').doc('lastTime').get();
    if (doc.exists) {
      const savedTime = doc.data().time;
      const currentTime = new Date().toLocaleTimeString('en-US', { hour12: false });

      if (savedTime === currentTime) {
        startRead();
      }
    }
  } catch (error) {
    console.error('Error checking time:', error);
  }
}

// Check time and speak every minute
setInterval(checkTimeAndSpeak, 60000);
